# 브라우저가 IP 주소를 찾는 방법

> 브라우저는 웹 서버에 요청을 보낼 때 IP 주소를 OS에 전달한다. 이때 IP 주소를 알아보기 위해 DNS 서버에 요청을 하게된다. 그렇다면 어떠한 과정으로 DNS 서버에서 IP 주소를 확인하는지 알아보자.



### 브라우저는 리졸버를 통해 DNS 서버에 요청한다 :bulb:

DNS 서버에 요청을 보내기 위해서 **리졸버**를 사용한다. 리졸버는 DNS 서버에 대응되는 클라이언트이다. 리졸버는 **Socket 라이브러리**에 들어있는 부품화한 프로그램으로 Socket 라이브러리 속에는 데이터를 송/수신할 때 사용하는 부품을 포함한 다양한 프로그램 부품이 들어있으며 그 중 하나가 리졸버이다.

**Socket 라이브러리는 OS에 포함되어 있고 애플리케이션(브라우저)에서 호출하여 사용된다.** 이렇게 리졸버를 호출하여 DNS 서버에 요청을 보내면 응답 메시지가 돌아오는데, 이때 브라우저에서 지정한 메모리 영역에 IP 주소를 포함시키고 브라우저는 해당 메모리 영역에서 IP 주소를 추출한다.



### 그렇다면 리졸버는 어떻게 동작하는 것일까 :question:

리졸버가 애플리케이션(브라우저)에서 호출되었을 때 제어권이 넘어가고 잠시 브라우저는 쉬게된다. 이후 리졸버는 DNS 서버에 요청하기 위한 메시지를 생성한다.

HTTP 메시지를 브라우저에서 송신할 수 없는 것처럼 **리졸버도 메시지를 송신하기 위해 OS에 의뢰한다.** 여기서 OS에 포함된 **프로토콜 스택**을 호출하여 실행을 의뢰하게 되는데 프로토콜 스택은 OS에 내장된 네트워크 제어용 소프트웨어이다.

프로토콜 스택을 호출하여 LAN 어댑터를 통해 메시지를 송신한다. 그렇다면 DNS 서버에서 메시지에 적힌 IP 주소를 찾고 일치하는 것이 있다면 클라이언트 측으로 송신을 한다. 여기서 리졸버가 내용을 해독하여 IP 주소를 추출하고 브라우저에 전달하게 된다.



### DNS 서버의 IP 주소는 누가 찾나 :question:

DNS 서버에 요청을 보낼 때도 DNS 서버의 IP 주소가 필요하다. 하지만 TCP/IP 설정의 하나로 컴퓨터에 미리 설정되어있다.



### :green_book: 정리

- 브라우저는 IP 주소를 찾기 위해 **리졸버**를 통해 DNS 서버에 요청한다.
- 리졸버는 OS 내부의 Socket 라이브러리에 포함되어 있고 브라우저에서 호출하여 사용한다.
- 리졸버는 DNS에 보낼 메시지를 생성하고 프로토콜 스택을 호출하여 전송한다.
- DNS에서 일치하는 IP 주소를 찾고 클라이언트에 보내며 리졸버가 DNS에서 수신받은 메시지를 해독하여 브라우저에 전달한다.





