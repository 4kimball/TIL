# 서버에 접속하기

> 소켓을 생성하고 connect를 호출한다고 서버와 연결되는 것이 아니다. 그전에 서버에 접속을 해야하며 접속의 의미와 어떻게 접속이 이루어지는지 알아본다.



### :one: 접속한다는 것은

이더넷이나 통신 회선 등의 케이블은 항상 연결이 되어있다. 클라이언트와 서버 사이에 연결된 케이블을 통해 데이터를 송/수신할 수 있는데 이를 위해 접속을 할 필요가 있다.

socket을 호출하는 동작으로는 프로토콜 스택에 어떠한 정보도 기록되지 않는다. 서버의 IP 주소나 포트 번호(소켓 식별)를 알려줘야하며 이 동작은 접속 동작의 한가지다. 서버측에서도 소켓이 만들어지긴 했지만 상대를 알 수 없기 때문에 클라이언트에서 송수신을 할 수 있냐는 요청을 받게된다. 이 과정에서 클라이언트와 서버의 프로토콜 스택이 정보를 갖게되며 이들이 접속 동작의 역할 중 하나가 된다.

데이터를 송/수신할 때 데이터를 일시적으로 저장하는 공간을 버퍼 메모리라고 하며, **버퍼 메모리를 확보**하는 것이 **접속한다는 의미**이다.



### :two: 헤더는 제어 정보를 담고있다.

클라이언트와 서버가 통신할 때마다 **제어정보를 부가하고 패킷의 맨 앞부분에 위치하며 이를 헤더**라고 한다. 헤더에도 TCP헤더, IP헤더 등을 식별할 수 있도록 표시를 해줘야한다. 

클라이언트와 서버는 헤더에 필요한 정보를 기록하여 연락을 취하면서  통신을 하고 있다.

- 클라이언트 : 데이터를 보냅니다?
- 서버 : 예
- 클라이언트 : 첫 번째 데이터를 보냅니다.
- 서버 : 첫 번째 데이터를 정상적으로 받았습니다.

위의 과정을 반복하면서 통신이 이루어지며 위의 동작이 헤더에 기록된 제어 정보에 의해 이루어진다. 



### :three: 접속하기

connect를 호출하여 서버의 IP주소와 포트 번호를 입력하면 프로토콜 스택의 TCP 담당 부분에 전달된다. 이후 서버측의 TCP와 제어 정보를 주고받으며 데이터 송신을 하겠다는 개시를 알린다.

이제 TCP 헤더를 만들어 IP에 전달하여 송신하도록 한다. 네트워크를 통해 서버의 IP에 도착하여 TCP에 전달하고 서버는 응답을 클라이언트에 돌려보낸다. 응답을 돌려보낼 때는 **ACK**의 비트도 1로 만들어 보내며 패킷을 받았다는 정보를 알리게된다.

다시 클라이언트는 패킷을 돌려받고 정상적으로 도착했는지에 대한 여부를 확인한다. 위와 같은 과정으로 소켓은 데이터를 송/수신할 수 있는 상태가 되며 이를 파이프라인이 연결되었다고 생각해도 된다.(실제로 연결된 것은 아니다)