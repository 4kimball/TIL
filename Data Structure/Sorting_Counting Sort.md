# Sorting : Counting Sort

> 수열에서 특정 숫자가 몇 번 존재하는지에 대한 횟수를 통해 그 수가 위치할 공간을 알려준다.



### :orange_book: 개념

카운팅 정렬을 한 번에 이해하기 어려울 수 있다. 그렇기 때문에 예시를 통해 알아보자.

- `[1, 0, 2, 0, 1, 3, 4, 2, 1, 4, 3]`이라는 수열이 존재한다고 하자. 

- 이 수열에서 최댓값은 `4`가 되는데 최댓값 만큼의 길이를 갖는 `count` 배열을 생성한다. 

- `count`안에 0 ~ 4의 수가 몇 번이나 존재하는지 각 인덱스에 횟수를 저장한다. 결과는 `[2, 3, 2, 2, 2]`이 된다. 각각 0은 2번, 1은 3번, 2는 2번, 3은 2번, 4는 2번 나타난다. 
- 이제 `count`에 있는 수들의 누적합을 구한다. 결과는 `[2, 5, 7, 9, 11]`처럼 나오게 되는데 두 번째 인덱스는 0과 1이 나온 수의 합을 저장한 것이다.  **누적합을 구한 이유는 데이터를 정렬할 때 인덱스로 활용하기 위함이다.**
- 이제 정렬을 해본다. 이때 처음의 수열에서 뒤에 있는 수부터 정렬하게 되는데 이는 `stable sort`를 위해서이다. *(추후에 stable sort 정리)* 
- 3을 누적합을 이용해 정렬을 시도한다. 3의 누적합은 9이며 3은 새로운 배열의 (9-1)인덱스에 저장된다. 그리고 다음 나오는 3을 위해 9에서 1을 빼준다. 
- 위와 같은 연산을 반복하게 되는데 특정 수의 누적합-1 인덱스에 계속해서 수를 배열하게 된다.



### :bulb: 구현

- 개념에서 설명한 것을 `python`으로 구현해보자.
- 리스트의 숫자 중 최댓값을 구하여 0으로 초기화된  `count` 리스트를 생성한다. +1을 해준 이유는 최댓값인 4로 하면 0~3까지의 인덱스가 생겨서 4를 포함시킬 수 없기 때문이다.
- 그리고 정렬된 값을 저장할 `result` 리스트를 원래 리스트의 길이만큼 생성한다.

```python
numbers = [1, 0, 2, 0, 1, 3, 4, 2, 1, 4, 3]
max_num = max(numbers)
count = [0] * (max_num+1)
result = [0 for _ in range(len(numbers))]
```

- 먼저 각 숫자가 몇 번 등장하는지 횟수를 `count`에 저장한다.
- 그리고 다시 누적합을 구하여 `count`에 저장한다.

```python
for number in numbers:
    count[number] += 1

# 누적합
for idx in range(1, len(count)):
    count[idx] = count[idx] + count[idx-1]
```

- 이제 누적합을 이용해 정렬을 해보자.
- 뒤의 숫자부터 정렬하기 때문에 `reversed()`를 통해 수열을 뒤집는다.
- 해당 숫자를 어떤 인덱스에 저장할지 `count`에서 가져와 -1을 하여 `idx`에 저장한다.
- `idx`를 해당 `result`인덱스에 저장한다.
- 이제 하나의 수가 정렬이 되었고 정렬된 숫자의 누적합을 1만큼 감소시켜 다음 수가 정렬되도록 한다.

```python
for number in reversed(numbers):
    idx = count[number] - 1
    result[idx] = number
    count[number] -= 1
```

- 정렬이 모두 되었다면 출력 결과를 보자.

```python
print(result)
# [0, 0, 1, 1, 1, 2, 2, 3, 3, 4, 4]
```



### :hourglass_flowing_sand: 성능

- 카운팅 정렬은 **Big-O 표기법으로 O(n)**만큼의 시간복잡도를 갖는다. 
- 만약 `[0, 1, 1000000]`이라는 수열이 있다면 수는 3개지만 1과 1000000 사이의 수를 카운팅해야 하는 비효율이 발생한다. 따라서 숫자들이 골고루 포함되어있는 상황(1~100점 까지 학생들의 성적)에서 사용할 수 있을 것이다.
- 카운팅 정렬을 애니메이션으로 쉽게 확인할 수 있는 주소이다.
  - https://www.cs.miami.edu/home/burt/learning/Csc517.091/workbook/countingsort.html